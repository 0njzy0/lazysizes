/*! lazysizes - v0.3.1-pre - 2014-10-29
 Licensed MIT */
!function(a){window.lazySizes=a(),"function"==typeof define&&define.amd&&define(function(){return window.lazySizes})}(function(){"use strict";function a(a,b){var c;window.picturefill?picturefill({reevaluate:!0,reparse:!0,elements:[a]}):window.respimage&&!respimage._.observer?(b&&(c=a[respimage._.ns],c&&(c[b.srcset?"srcset":"src"]=void 0)),respimage({reparse:!0,elements:[a]})):!window.HTMLPictureElement&&window.console&&"complete"==t.readyState&&console.log("use a respimg polyfill: http://bit.ly/1FCts3P")}function b(a){u++,a=e(a),D(a,Q),D(a,Q,!0),clearTimeout(H),H=setTimeout(Q,5e3)}function c(a){var b=t.createElement("script"),c=a.parentNode;return a.removeAttribute(j.srcAttr),c.insertBefore(b,a),B(function(){q(a,j.lazyClass)}),b}function d(){n=0,clearTimeout(m)}function e(b,d){var e,f,h,i,k,l,m,n,o,r=F(b,"lazybeforeunveil",{force:!!d});if(!r.defaultPrevented&&(k=b.getAttribute(j.sizesAttr),l=b.getAttribute(j.srcAttr),m=b.getAttribute(j.srcsetAttr),n=b.parentNode,l||m)){if(v.test(b.nodeName)&&(b=c(b)),x.test(b.nodeName||"")){if(C[l])return;C[l]=!0}else if(y.test(b.nodeName||"")){if(o=w.test(n.nodeName||""),!A&&!o&&!d&&!b.complete&&b.getAttribute("src")&&b.src&&!b.lazyload)return D(b,E),void D(b,E,!0);if(o)for(e=n.getElementsByTagName("source"),f=0,h=e.length;h>f;f++)i=e[f].getAttribute(j.srcsetAttr),i&&e[f].setAttribute("srcset",i)}k&&("auto"==k?g(b,!0):b.setAttribute("sizes",k),j.clearAttr&&b.removeAttribute(j.sizesAttr)),m?(b.setAttribute("srcset",m),j.clearAttr&&b.removeAttribute(j.srcsetAttr)):l&&(b.setAttribute("src",l),j.clearAttr&&b.removeAttribute(j.srcAttr))}return B(function(){q(b,j.lazyClass),"auto"==k&&p(b,j.autosizesClass),(m||k)&&a(b,{srcset:m,src:l})}),b}function f(){l=0,clearTimeout(k)}function g(b,c){var d,e,f,g,h,i,k,l;if(g=b.parentNode){if(d=g.offsetWidth,e=b.offsetWidth,f=e>d?e:d,!f&&!b._lazysizesWidth)for(;g&&g!=t.body&&!f;)f=g.offsetWidth,g=g.parentNode;if(l=F(b,"lazybeforesizes",{width:f,polyfill:!c}),!l.defaultPrevented&&(f=l.details.width,f&&f!==b._lazysizesWidth&&(!j.onlyLargerSizes||!b._lazysizesWidth||b._lazysizesWidth<f))){if(b._lazysizesWidth=f,f+="px",b.setAttribute("sizes",f),w.test(g.nodeName||""))for(h=g.getElementsByTagName("source"),i=0,k=h.length;k>i;i++)h[i].setAttribute("sizes",f);l.details.polyfill&&a(b)}}}if(Date.now&&window.document.getElementsByClassName&&Object.freeze){var h,i,j,k,l,m,n,o,p,q,r,s,t=window.document,u=0,v=/^(?:span|div)$/i,w=/^picture$/i,x=/^script$/i,y=/^img$/i,z=10,A=/rident|hrome/.test(navigator.userAgent||""),B=window.setImmediate||window.setTimeout,C={},D=function(a,b,c){var d=c?"addEventListener":"removeEventListener";a[d]("load",b,!1),a[d]("error",b,!1)},E=function(a){D(a.target,E),e(a.target,!0)},F=function(a,b,c){var d=t.createEvent("Event");return d.initEvent(b,!0,!0),d.details=c||{},a.dispatchEvent(d),d};t.documentElement.classList?(p=function(a,b){a.classList.add(b)},q=function(a,b){a.classList.remove(b)},r=function(a,b){return a.classList.contains(b)}):(p=function(a,b){r(a,b)||(a.className+=" "+b)},q=function(a,b){var c;r(a,b)&&(c=new RegExp("(\\s|^)"+b+"(\\s|$)"),a.className=a.className.replace(c," "))},r=function(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))});var G,H,I,J,K,L,M,N,O,P=Date.now(),Q=function(a){u--,clearTimeout(H),a&&a.target&&D(a.target,Q),(!a||0>u||!a.target)&&(u=0)},R=function(){var a,b,c=function(){b=!1},e=function(){clearTimeout(a),d(),S(),setTimeout(c)};return{debounce:function(){clearTimeout(a),clearTimeout(o),b=!0,a=setTimeout(e,66)},throttled:function(){var c;b||(b=!0,clearTimeout(a),c=Date.now()-P,c=c>300?9:99,a=setTimeout(e,c))}}}(),S=function(){var a,c,d;if(G=h.length,P=Date.now(),G){for(I=window.innerWidth+z,J=window.innerHeight+z,O=-1*z;G>n;n++)if(a=h[n].getBoundingClientRect(),(N=a.bottom)>=O&&(K=a.top)<=J&&(M=a.right)>=O&&(L=a.left)<=I&&(N||M||L||K))e(h[n]),d=!0;else{if(G-1>n&&Date.now()-P>9){n++,c=!1,m=setTimeout(S,4);break}!d&&s&&!c&&j.preloadAfterLoad&&2>u&&(N||M||L||K||"auto"!=h[n].getAttribute(j.sizesAttr))&&(c=h[n])}c&&!d&&b(c)}},T=function(){var a,b=function(){clearTimeout(a),f(),U()};return function(){clearTimeout(a),clearTimeout(k),a=setTimeout(b,99)}}(),U=function(){var a,b,c,d=i.length;if(d)for(b=Date.now(),c=l||0,a=c+3,f();d>c;c++)if(g(i[c]),c>a&&d-1>c&&Date.now()-b>9){l=c+1,k=setTimeout(U,4);break}},V=function(){z=400,clearTimeout(o),t.addEventListener("load",R.throttled,!0),s=!0},W=function(){var a=t.body||t.documentElement;j.mutation&&(window.MutationObserver?new MutationObserver(R.throttled).observe(t.documentElement,{childList:!0,subtree:!0,attributes:!0}):(a.addEventListener("DOMNodeInserted",R.throttled,!0),t.documentElement.addEventListener("DOMAttrModified",R.throttled,!0))),j.hover&&t.addEventListener("mouseover",R.throttled,!0),t.addEventListener("focus",R.throttled,!0),window.addEventListener("hashchange",R.throttled,!0),"onmozfullscreenchange"in a?window.addEventListener("mozfullscreenchange",R.throttled,!0):"onwebkitfullscreenchange"in a?window.addEventListener("webkitfullscreenchange",R.throttled,!0):window.addEventListener("fullscreenchange",R.throttled,!0),j.cssanimation&&(t.addEventListener("animationstart",R.throttled,!0),t.addEventListener("transitionstart",R.throttled,!0))};return j=window.lazySizesConfig||{},function(){var a,b={mutation:!0,hover:!0,cssanimation:!0,lazyClass:"lazyload",scroll:!0,autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",preloadAfterLoad:!1,onlyLargerSizes:!0};for(a in b)a in j||(j[a]=b[a])}(),setTimeout(function(){h=t.getElementsByClassName(j.lazyClass),i=t.getElementsByClassName(j.autosizesClass),j.scroll&&addEventListener("scroll",R.throttled,!0),addEventListener("resize",R.debounce,!1),addEventListener("resize",T,!1),/^i|^loade|c/.test(t.readyState)?W():t.addEventListener("DOMContentLoaded",W,!1),"complete"==t.readyState?V():(addEventListener("load",V,!1),t.addEventListener("readystatechange",R.throttled,!1)),R.throttled(),Object.freeze(j)}),{cfg:j,updateAllSizes:T,updateAllLazy:R.throttled,unveilLazy:function(a){r(a,j.lazyClass)&&e(a)},updateSizes:g,updatePolyfill:a}}});