/*! lazysizes - v0.1.2-pre - 2014-10-13
 Licensed MIT */
!function(a){window.lazySizes=a(),"function"==typeof define&&define.amd&&define(function(){return window.lazySizes})}(function(){"use strict";function a(a,b){var c;window.picturefill?picturefill({reevaluate:!0,reparse:!0,elements:[a]}):window.respimage&&!respimage._.observer?(b&&(c=a[respimage._.ns],c&&(c[b.srcset?"srcset":"src"]=void 0)),respimage({reparse:!0,elements:[a]})):!window.HTMLPictureElement&&window.console&&"complete"==u.readyState&&console.log("Please use a responsive image polyfill, like respimage or picturefill. https://github.com/aFarkas/respimage")}function b(a){t=!0,a=e(a),a.addEventListener("load",Q,!1),a.addEventListener("readystatechange",Q,!1),a.addEventListener("error",Q,!1),clearTimeout(N),N=setTimeout(Q,5e3)}function c(a){var b,c,d,e,f,g,h=a.getAttribute("data-tag")||"img",i=a.attributes;if(f=u.createElement(h),"script"!=h)for(b=0,c=i.length;c>b;b++)d=i[b].nodeName,e=d.replace(/^data\-/,""),"tag"!=e&&(!z[e]&&d in f||(e=d),f.setAttribute(e,i[b].value));return g=a.parentNode,g&&(g.insertBefore(f,a),"script"!=h?g.removeChild(a):(a.removeAttribute(j.srcAttr),B(function(){q(a,j.lazyClass)}))),f}function d(){n=0,clearTimeout(m)}function e(b,d){var e,f,h,i,k=b.getAttribute(j.sizesAttr),l=b.getAttribute(j.srcAttr),m=b.getAttribute(j.srcsetAttr),n=b.parentNode;if(l||m){if(v.test(b.nodeName)&&(b=c(b)),x.test(b.nodeName||"")){if(C[l])return;C[l]=!0}else if(y.test(b.nodeName||"")){if(!d&&!b.complete&&b.getAttribute("src")&&b.src&&!b.lazyload)return b.removeEventListener("load",D,!1),b.removeEventListener("error",D,!1),b.addEventListener("load",D,!1),void b.addEventListener("error",D,!1);if(w.test(n.nodeName||""))for(e=n.getElementsByTagName("source"),f=0,h=e.length;h>f;f++)i=e[f].getAttribute(j.srcsetAttr),i&&e[f].setAttribute("srcset",i)}k&&("auto"==k?g(b,!0):b.setAttribute("sizes",k),b.removeAttribute(j.sizesAttr),!m&&window.console&&b.getAttribute("srcset")&&console.log("using lazysizes with a `srcset` attribute is not good. Use `data-srcset` instead")),m?(b.setAttribute("srcset",m),b.removeAttribute(j.srcsetAttr)):l&&(b.setAttribute("src",l),b.removeAttribute(j.srcAttr))}return B(function(){q(b,j.lazyClass),"auto"==k&&p(b,j.autosizesClass),(m||k)&&a(b,{srcset:m,src:l})}),b}function f(){l=0,clearTimeout(k)}function g(b,c){var d,e,f,g,h,i,j;if(g=b.parentNode,g&&(d=g.offsetWidth,e=b.offsetWidth,f=e>d?e:d,f&&(!b._lazysizesWidth||e>99))){if(b._lazysizesWidth=1,f+="px",b.setAttribute("sizes",f),w.test(g.nodeName||""))for(h=g.getElementsByTagName("source"),i=0,j=h.length;j>i;i++)h[i].setAttribute("sizes",f);c||a(b)}}if(Date.now&&window.document.getElementsByClassName){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=window.document,v=/^(?:span|div)$/i,w=/^picture$/i,x=/^script$/i,y=/^img$/i,z={sizes:1,src:1,srcset:1},A=66,B=window.setImmediate||window.setTimeout,C={},D=function(a){a.target.removeEventListener("load",D,!1),a.target.removeEventListener("error",D,!1),e(a.target,!0)};u.documentElement.classList?(p=function(a,b){a.classList.add(b)},q=function(a,b){a.classList.remove(b)},r=function(a,b){a.classList.contains(b)}):(p=function(a,b){r(a,b)||(a.className+=" "+b)},q=function(a,b){var c;r(a,b)&&(c=new RegExp("(\\s|^)"+b+"(\\s|$)"),a.className=a.className.replace(c," "))},r=function(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))});var E,F,G,H,I,J,K,L,M,N,O=function(){var a,b,c=function(){b=!1},e=function(){clearTimeout(a),d(),P(),setTimeout(c)};return{debounce:function(){clearTimeout(a),clearTimeout(o),b=!0,a=setTimeout(e,66)},throttled:function(){b||(b=!0,clearTimeout(a),a=setTimeout(e,99))}}}(),P=function(){var a,c,d;if(E=h.length){for(F=Date.now(),G=window.innerWidth+A,H=window.innerHeight+A,M=-1*A;E>n;n++)if(a=h[n].getBoundingClientRect(),(L=a.bottom)>=M&&(I=a.top)<=H&&(K=a.right)>=M&&(J=a.left)<=G&&(L||K||J||I))e(h[n]),d=!0;else if(!d&&s&&!c&&j.preloadAfterLoad&&!t&&(L||K||J||I||"auto"!=h[n].getAttribute(j.sizesAttr))&&(c=h[n]),E-1>n&&Date.now()-F>7){n+=1,m=setTimeout(P,20);break}c&&!d&&b(c)}},Q=function(a){t=!1,clearTimeout(N),a&&a.target&&(a.target.removeEventListener("load",Q,!1),a.target.removeEventListener("error",Q,!1),a.target.removeEventListener("readystatechange",Q,!1))},R=function(){var a,b=function(){clearTimeout(a),f(),S()};return function(){clearTimeout(a),clearTimeout(k),a=setTimeout(b,99)}}(),S=function(){var a,b,c,d=i.length;if(d)for(b=Date.now(),c=l||0,a=c+3,f();d>c;c++)if(g(i[c]),c>a&&d-1>c&&Date.now()-b>9){l=c+1,k=setTimeout(S,20);break}},T=function(){A*=5,clearTimeout(o),u.addEventListener("load",O.throttled,!0),s=!0},U=function(){var a=u.body||u.documentElement;j.mutation&&(window.MutationObserver?new MutationObserver(O.throttled).observe(u.documentElement,{childList:!0,subtree:!0,attributes:!0}):(a.addEventListener("DOMNodeInserted",O.throttled,!0),u.documentElement.addEventListener("DOMAttrModified",O.throttled,!0))),j.hover&&u.addEventListener("mouseover",O.throttled,!0),u.addEventListener("focus",O.throttled,!0),window.addEventListener("hashchange",O.throttled,!0),"onmozfullscreenchange"in a?window.addEventListener("mozfullscreenchange",O.throttled,!0):"onwebkitfullscreenchange"in a?window.addEventListener("webkitfullscreenchange",O.throttled,!0):window.addEventListener("fullscreenchange",O.throttled,!0),j.cssanimation&&(u.addEventListener("animationstart",O.throttled,!0),u.addEventListener("transitionstart",O.throttled,!0))};return setTimeout(function(){var a,b={mutation:!0,hover:!0,cssanimation:!0,lazyClass:"lazyload",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",preloadAfterLoad:!1};j=window.lazySizesConfig||{};for(a in b)a in j||(j[a]=b[a]);h=u.getElementsByClassName(j.lazyClass),i=u.getElementsByClassName(j.autosizesClass),window.addEventListener("scroll",O.throttled,!1),(u.body||u.documentElement).addEventListener("scroll",O.throttled,!0),u.addEventListener("touchmove",O.throttled,!1),window.addEventListener("resize",O.debounce,!1),window.addEventListener("resize",R,!1),/^i|^loade|c/.test(u.readyState)?U():u.addEventListener("DOMContentLoaded",U,!1),"complete"==u.readyState?T():(window.addEventListener("load",T,!1),u.addEventListener("readystatechange",O.throttled,!1)),O.throttled(),"lazySizesConfig"in window&&(window.lazySizesConfig=null)},u.body?9:99),{updateAllSizes:R,updateAllLazy:O.throttled,unveilLazy:function(a){r(a,j.lazyClass)&&e(a)},updateSizes:g,transformDummy:c,updatePolyfill:a}}});